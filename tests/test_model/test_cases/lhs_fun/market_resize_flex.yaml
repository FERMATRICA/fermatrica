- description: test_market_resize_flex_wght1 function testing case 0
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
  exp_err: False
  expected_result: !pd.Series
    data:  [0.0, 1.19231, -0.08421, 0.70524, 0.32189, -0.0, 0.23077, 1.55789, 1.51899, -0.71388, 0.0, -0.42308,
            0.52632, 0.77577, 4.39199, 18.15789, -1.83439, 48.16667, -18.80441, 13.36341, -3.15789, 17.83439,
            -31.16667, 36.80441, 5.63659]
    dtype: 'float64'

- description: test_market_resize_flex_wght0 function testing case 1
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
    wght: 0
  exp_err: False
  expected_result: !pd.Series
    data:  [24.0, 31.0, -2.0, 13.0, 4.5, -23.5, 6.0, 37.0, 28.0, -9.98, 10.0, -11.0, 12.5, 14.3, 61.4, -115.0, 2.16,
      34.0, -18.0, 56.9, 20.0, -21.0, -22.0, 35.23, 24.0]
    dtype: 'float64'

- description: test_market_resize_flex_wght1 function testing case 2
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
    wght: 1
  exp_err: False
  expected_result: !pd.Series
    data:  [0.0, 1.19231, -0.08421, 0.70524, 0.32189, -0.0, 0.23077, 1.55789, 1.51899, -0.71388, 0.0, -0.42308,
            0.52632, 0.77577, 4.39199, 18.15789, -1.83439, 48.16667, -18.80441, 13.36341, -3.15789, 17.83439,
            -31.16667, 36.80441, 5.63659]
    dtype: 'float64'

- description: test_market_resize_flex_base function testing case 3
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
    wght: 0.15
  exp_err: False
  expected_result: !pd.Series
    data:  [20.4, 26.52885, -1.71263, 11.15579, 3.87328, -19.975, 5.13462, 31.68368, 24.02785, -8.59008, 8.5, -9.41346,
            10.70395, 12.27137, 52.8488, -95.02632, 1.56084, 36.125, -18.12066, 50.36951, 16.52632, -15.17484, -23.375,
            35.46616, 21.24549]
    dtype: 'float64'

- description: test_market_resize_flex_ndarray function testing case 4
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !np.array
      object: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
    wght: 0
  exp_err: False
  expected_result: !pd.Series
    data:  [24.0, 31.0, -2.0, 13.0, 4.5, -23.5, 6.0, 37.0, 28.0, -9.98, 10.0, -11.0, 12.5, 14.3, 61.4, -115.0, 2.16,
      34.0, -18.0, 56.9, 20.0, -21.0, -22.0, 35.23, 24.0]
    dtype: 'float64'

- description: test_market_resize_flex_zero_div function testing case 5
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !np.array
      object: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 0]
    wght: 0.15
  exp_err: False
  expected_result: !pd.Series
    data:  [20.4, 26.52885, -1.71263, 11.15579, 3.87328, -19.975, 5.13462, 31.68368, 24.02785, -8.59008, 8.5, -9.41346,
            10.70395, 12.27137, 52.8488, -95.02632, 1.56084, 36.125, -18.12066, 51.215, 16.52632, -15.17484, -23.375,
            35.46616, 0.0]
    dtype: 'float64'

