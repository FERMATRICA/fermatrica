- description: test_log_exp_base function testing case 0
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
  exp_err: False
  expected_result: !pd.Series
    data:  [3.21888, 3.46574, nan, 2.63906, 1.70475, nan, 1.94591, 3.63759, 3.3673, nan, 2.3979, nan, 2.60269, 2.72785,
            4.13357, nan, 1.15057, 3.55535, nan, 4.05872, 3.04452, nan, nan, 3.58989, 3.21888]
    dtype: 'float64'

- description: test_log_exp_false function testing case 1
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
    to_original: False
  exp_err: False
  expected_result: !pd.Series
    data:  [3.21888, 3.46574, nan, 2.63906, 1.70475, nan, 1.94591, 3.63759, 3.3673, nan, 2.3979, nan, 2.60269, 2.72785,
            4.13357, nan, 1.15057, 3.55535, nan, 4.05872, 3.04452, nan, nan, 3.58989, 3.21888]
    dtype: 'float64'

- description: test_log_exp_true function testing case 2
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !pd.Series
      data: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
    to_original: True
  exp_err: False
  expected_result: !pd.Series
    data:  [26489122128.84347, 29048849665246.43, -0.86466, 442412.39201, 89.01713, -1.0, 402.42879,
            1.1719142372802612e+16, 1446257064290.475, -0.99995, 22025.46579, -0.99998, 268336.28652, 1623344.98501,
            4.6310683293169294e+26, -1.0, 7.67114, 583461742527453.9, -1.0, 5.144652203874535e+24, 485165194.40979,
            -1.0, -1.0, 1996156546829962.0, 26489122128.84347]

- description: test_log_exp_ndarray function testing case 3
  params:
    ds: !pd.DataFrame
      data:
        date: [ '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05', '2023-01-01', '2023-01-02', '2023-01-03', '2023-01-04', '2023-01-05' ]
        pred_mrk: [ 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 0, 1, 2, 3, 4, 15, 16, 17, 18, 19, 15, 16, 17, 18, 19 ]
        listed: [ 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4, 1, 2, 2, 3, 4 ]
        market: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ]
        bs_key: [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4 ]
    y: !np.array
      object: [ 24, 31, -2, 13, 4.5, -23.5, 6, 37, 28, -9.98, 10, -11, 12.5, 14.3, 61.4, -115, 2.16, 34, -18, 56.9, 20,
              -21, -22, 35.23, 24 ]
  exp_err: False
  expected_result: !pd.Series
    data:  [3.21888, 3.46574, nan, 2.63906, 1.70475, nan, 1.94591, 3.63759, 3.3673, nan, 2.3979, nan, 2.60269, 2.72785,
            4.13357, nan, 1.15057, 3.55535, nan, 4.05872, 3.04452, nan, nan, 3.58989, 3.21888]
    dtype: 'float64'